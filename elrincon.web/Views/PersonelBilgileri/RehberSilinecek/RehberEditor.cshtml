@model elrincon.web.Models.PersonelBilgileri.Rehber.RehberEditorModel

@{
    ViewBag.Title = "Rehber Ekle ";
    Layout = "~/Views/_Modal.cshtml";
}
<style>
  /*  .not_change_div {
        pointer-events: none;
        display: inline-block;
        background-color: #F0F0F0;
        border-radius: 6px;
        border: 1px solid #EEE;
    }*/

    .open-modal .window {
        max-width: 55% !important;
    }

</style>
<div class="row el_row">
    <div class="cell-6">
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Adı :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputAdiModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Soyadı :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputSoyadiModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    FAX :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputFaxModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Tel. No1 :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputTelNo1Model);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Tel. No2 :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputTelNo2Model);}
                </div>
            </div>
        </div>
    </div>
    <div class="cell-6">
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Mail Adresi :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputMailAdresiModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Şubesi :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElSelect", @Model.SelectSubeModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Ülke :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElSelect", @Model.SelectUlkeModel);}
                </div>
            </div>
        </div>

        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Posta Kodu :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputPostaKoduModel);}
                </div>
            </div>
        </div>
    </div>

    <div class="row el_row">

        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Muhasebe Kodu :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputMuhasebeKoduModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Dövüz Kodu :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElSelect", @Model.SelectDovizKoduModel);}
                </div>
            </div>
        </div>
    </div>
    <div class="cell-12">
        <div class="row">
            <div class="input-caption">
                Adresi :
            </div>
            <div class="input-value">
                @{Html.RenderPartial("ElInput", @Model.InputAdresiModel);}
            </div>
        </div>
    </div>

    <div class="cell-12">
        <div class="row">
            <div class="input-caption">
                NOT :
            </div>
            <div class="input-value">
                @{Html.RenderPartial("ElInput", @Model.InputAciklamaModel);}
            </div>
        </div>
    </div>
    <div class="cell-12 not_change_div" style="">
        @*pointer-events: none;*@
        <div class="row">
            @{Html.RenderPartial("/Views/Shared/KardanYuzdelikOranlariDisPersonel.cshtml", @Model.ModelKardanOrani);}
        </div>
    </div>

    <div class="cell" align="right">
        <div class="row" style=" width: fit-content;">
            <button class="el-action-button save_rehber_data"> Kaydet </button>
        </div>
    </div>
</div>
<script>
    var id_value = '@Model.Id';
    $('.save_rehber_data').on("click",
        function () {
            var modelSave = {};
            var saveYuzdelikOraniModels = [];

            $('.outoNewRowOnChange > .tr').each(function(index, tr) {
                var currentRow=$(this);

                var tip = currentRow.find(".td:eq(0) select:eq(0)").val();
                var nsy = currentRow.find(".td:eq(1) input:eq(0)").val();

                saveYuzdelikOraniModels.push({
                    UrunTipi: tip,
                    YuzdeTip:1,//yuzdelik rehber
                    NarmalSatisYuzdeligi : nsy
                    });
            });
            //console.log(saveYuzdelikOraniModels.toString());

            modelSave.Id = id_value;
            modelSave.Ad = $('#rehber_editor_input_adi').val();
            modelSave.Soyad = $('#rehber_editor_input_soyadi').val();
            modelSave.TelNo1 = $('#rehber_editor_input_tel_no1').val();
            modelSave.TelNo2 = $('#rehber_editor_input_tel_no2').val();
            modelSave.MailAdresi = $('#rehber_editor_input_mail_adres').val();
            modelSave.Subesi = $('#rehber_editor_model_select_sube_id').val();
            modelSave.Adres = $('#rehber_editor_input_adres').val();
            modelSave.MuhasebeKodu = $('#rehber_editor_input_muhasebe_kodu').val();
            modelSave.DovizKodu = $('#rehber_editor_model_select_maas_doviz_kodu').val();
            modelSave.Aciklama = $('#rehber_editor_input_aciklama').val();
            modelSave.InputFaxModel = $('#rehber_editor_input_fax').val();
            modelSave.InputPostaKoduModel = $('#rehber_editor_input_posta_kodu').val();
            modelSave.SelectUlkeModel = $('#rehber_editor_model_select_ulke_id').val();
            modelSave.SaveYuzdelikOraniModels = saveYuzdelikOraniModels;

            console.log(modelSave);

            var dataSend = JSON.stringify({ 'model': modelSave });
            //console.log({dataSend});

            $.ajax({
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                type: 'POST',
                url: '@Url.Action("SaveOrUpdate","RehberEditor")',
                data: dataSend,
                TYPE: 'POST',
                success: function (result) {

                    if (result.result == "ok") {
                        hideModal();
                        reloadGrid_rehber_liste_grid_id();

                        ShowAlertMessage("Başarılı", "İşlem başarıyla gerçekleşti","success");

                    } else {
                        ShowAlertMessage("Hata", result.message, "alert");
                    }
                }
            });
        });
</script>