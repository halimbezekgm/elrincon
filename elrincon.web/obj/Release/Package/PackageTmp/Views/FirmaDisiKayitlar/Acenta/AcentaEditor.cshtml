
@model elrincon.web.Models.FirmaDisiKayitlar.Acenta.AcentaEditorModel
@{
    ViewBag.Title = "Acente Ekle ";
    Layout = "~/Views/_Modal.cshtml";
}
<style>
    /*  .not_change_div {
        pointer-events: none;
        display: inline-block;
        background-color: #F0F0F0;
        border-radius: 6px;
        border: 1px solid #EEE;
    }*/

    .open-modal .window {
        max-width: 96% !important;
    }
</style>

<div class="row el_row">
    <div class="cell-6">
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Adı :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputAdiModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Mail Adresi :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputMailAdresiModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    FAX :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputFaxModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Tel. No1 :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputTelNo1Model);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Tel. No2 :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputTelNo2Model);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    İlgili Kişi 1:
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputIlgiliKisi1Model);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    İlgili Kişi 2:
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputIlgiliKisi2Model);}
                </div>
            </div>
        </div>
    </div>
    <div class="cell-6">
    
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Şehir:
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputSehirModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Şubesi :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElSelect", @Model.SelectSubeModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Ülke :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElSelect", @Model.SelectUlkeModel);}
                </div>
            </div>
        </div>

        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Posta Kodu :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputPostaKoduModel);}
                </div>
            </div>
        </div>
    </div>

    <div class="row el_row">

        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Muhasebe Kodu :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElInput", @Model.InputMuhasebeKoduModel);}
                </div>
            </div>
        </div>
        <div class="cell">
            <div class="row">
                <div class="input-caption">
                    Dövüz Kodu :
                </div>
                <div class="input-value">
                    @{Html.RenderPartial("ElSelect", @Model.SelectDovizKoduModel);}
                </div>
            </div>
        </div>
    </div>
    <div class="cell-12">
        <div class="row">
            <div class="input-caption">
                Adresi :
            </div>
            <div class="input-value">
                @{Html.RenderPartial("ElInput", @Model.InputAdresiModel);}
            </div>
        </div>
    </div>

    <div class="cell-12">
        <div class="row">
            <div class="input-caption">
                NOT :
            </div>
            <div class="input-value">
                @{Html.RenderPartial("ElInput", @Model.InputAciklamaModel);}
            </div>
        </div>
    </div>
    <div class="cell-12 not_change_div" style="">
        @*pointer-events: none;*@
        <div class="row">
            @{Html.RenderPartial("/Views/Shared/KardanYuzdelikOranlariAcenta.cshtml", @Model.ModelKardanOrani);}
        </div>
    </div>

    <div class="cell" align="right">
        <div class="row" style=" width: fit-content;">
            <button class="el-action-button save_acenta_data"> Kaydet </button>
        </div>
    </div>
</div>
<script>
    var id_value = '@Model.Id';
    $('.save_acenta_data').on("click",
        function () {
            var modelSave = {};
            var saveYuzdelikOraniModels = [];

            $('.outoNewRowOnChange > .tr').each(function(index, tr) {
                var currentRow=$(this);

                var tip = currentRow.find(".td:eq(0) select:eq(0)").val();
                var nsp1 = currentRow.find(".td:eq(1) input:eq(0)").val();
                var nsp2 = currentRow.find(".td:eq(1) input:eq(1)").val();
                var nsy = currentRow.find(".td:eq(1) input:eq(2)").val();

                var ksp1 = currentRow.find(".td:eq(2) input:eq(0)").val();
                var ksp2 = currentRow.find(".td:eq(2) input:eq(1)").val();
                var ksy = currentRow.find(".td:eq(2) input:eq(2)").val();

                var isp1 = currentRow.find(".td:eq(3) input:eq(0)").val();
                var isp2 = currentRow.find(".td:eq(3) input:eq(1)").val();
                var isy = currentRow.find(".td:eq(3) input:eq(2)").val();

                var ydsp1 = currentRow.find(".td:eq(4) input:eq(0)").val();
                var ydsp2 = currentRow.find(".td:eq(4) input:eq(1)").val();
                var ydsy = currentRow.find(".td:eq(4) input:eq(2)").val();

                var gcsp1 = currentRow.find(".td:eq(5) input:eq(0)").val();
                var gcsp2 = currentRow.find(".td:eq(5) input:eq(1)").val();
                var gcsy = currentRow.find(".td:eq(5) input:eq(2)").val();


                saveYuzdelikOraniModels.push({
                    UrunTipi: tip,
                    YuzdeTip:1,//yuzdelik acenta
                    NarmalSatisParite1 : nsp1,
                    NarmalSatisParite2 : nsp2,
                    NarmalSatisYuzdeligi : nsy,
                    KapiSatisParite1 : ksp1,
                    KapiSatisParite2 : ksp2,
                    KapiSatisYuzdeligi : ksy,
                    InternetSatisParite1 : isp1,
                    InternetSatisParite2 : isp2,
                    InternetSatisYuzdeligi : isy,
                    YurtDisiSatisParite1 : ydsp1,
                    YurtDisiSatisParite2 : ydsp2,
                    YurtDisiSatisYuzdeligi : ydsy,
                    GenelCiroSatisParite1 : gcsp1,
                    GenelCiroSatisParite2 : gcsp2,
                    GenelCiroSatisYuzdeligi : gcsy
                    });
            });
            //console.log(saveYuzdelikOraniModels.toString());

            modelSave.Id = id_value;
            modelSave.Ad = $('#acenta_editor_input_adi').val();
            modelSave.Sehir = $('#acenta_editor_input_sehir').val();
            modelSave.TelNo1 = $('#acenta_editor_input_tel_no1').val();
            modelSave.TelNo2 = $('#acenta_editor_input_tel_no2').val();
            modelSave.IlgiliKisi1 = $('#acenta_editor_input_ilgili_kisi1').val();
            modelSave.IlgiliKisi2 = $('#acenta_editor_input_ilgili_kisi2').val();
            modelSave.MailAdresi = $('#acenta_editor_input_mail_adres').val();
            modelSave.Subesi = $('#acenta_editor_model_select_sube_id').val();
            modelSave.Bolumu = $('#acenta_editor_model_select_bolum_id').val();
            modelSave.Adres = $('#acenta_editor_input_adres').val();
            modelSave.MuhasebeKodu = $('#acenta_editor_input_muhasebe_kodu').val();
            modelSave.DovizKodu = $('#acenta_editor_model_select_maas_doviz_kodu').val();
            modelSave.InputFaxModel = $('#acenta_editor_input_fax').val();
            modelSave.SelectUlkeModel = $('#acenta_editor_model_select_ulke_id').val();
            modelSave.InputPostaKoduModel = $('#acenta_editor_input_posta_kodu').val();
            modelSave.Aciklama = $('#acenta_editor_input_aciklama').val();
            modelSave.SaveYuzdelikOraniModels = saveYuzdelikOraniModels;

            console.log(modelSave);

            var dataSend = JSON.stringify({ 'model': modelSave });
            //console.log({dataSend});

            $.ajax({
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                type: 'POST',
                url: '@Url.Action("SaveOrUpdate","AcentaEditor")',
                data: dataSend,
                beforeSend: function () {
                    $("#loading").css("display", "block");
                },
                TYPE: 'POST',
                success: function (result) {

                    if (result.result == "ok") {
                        hideModal();
                        reloadGrid_acenta_liste_grid_id();

                        ShowAlertMessage("Başarılı", "İşlem başarıyla gerçekleşti","success");

                    } else {
                        ShowAlertMessage("Hata", result.message, "alert");
                    }
                }
            }).done(function () {
                $("#loading").css("display", "none");
            });
        });
</script>